{"remainingRequest":"C:\\Users\\Ares\\Desktop\\washing-master\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Ares\\Desktop\\washing-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Ares\\Desktop\\washing-master\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!C:\\Users\\Ares\\Desktop\\washing-master\\src\\components\\ForgetPwd.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\Ares\\Desktop\\washing-master\\src\\components\\ForgetPwd.vue","mtime":1626249295995},{"path":"C:\\Users\\Ares\\Desktop\\washing-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ares\\Desktop\\washing-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Ares\\Desktop\\washing-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ares\\Desktop\\washing-master\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1624994108000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJ2YW50L2VzL3RvYXN0L3N0eWxlIjsKaW1wb3J0IF9Ub2FzdCBmcm9tICJ2YW50L2VzL3RvYXN0IjsKaW1wb3J0IFZ1ZUNvb2tpZXMgZnJvbSAndnVlLWNvb2tpZXMnOwppbXBvcnQgeyByZWFjdGl2ZSB9IGZyb20gJ3Z1ZSc7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCBtZDUgZnJvbSAnanMtbWQ1JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdQd2RGb3JtJywKICBiZWZvcmVNb3VudDogZnVuY3Rpb24gYmVmb3JlTW91bnQoKSB7CiAgICBpZiAoVnVlQ29va2llcy5nZXQoIkxvZ2luU3RhdHVzIikgPT0gMSkgewogICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICIuL29yZGVyIjsKICAgIH0KICB9LAogIHNldHVwOiBmdW5jdGlvbiBzZXR1cCgpIHsKICAgIHZhciBzdGF0ZSA9IHJlYWN0aXZlKHsKICAgICAgcGhvbmU6ICcnLAogICAgICBuZXdQYXNzd29yZDogJycsCiAgICAgIGRiQ29uZmlyZW1lZFB3ZDogJycsCiAgICAgIGNvZGU6ICcnCiAgICB9KTsKICAgIHZhciBhdmFpbGFibGUgPSB0cnVlOwoKICAgIHZhciBzZW5kU01TID0gZnVuY3Rpb24gc2VuZFNNUygpIHsKICAgICAgaWYgKHN0YXRlLnBob25lID09ICIiKSB7CiAgICAgICAgX1RvYXN0KCLoq4vovLjlhaXkvaDnmoToga/ntaHpm7voqbEiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZyhzdGF0ZS5waG9uZSk7IC8vIGF4aW9zLnBvc3QoImh0dHA6Ly8xMjEuMTk5LjU0LjQzOjg4ODgvdG91cmlzdC9zZW5kU01TVmVyaWZpY2F0aW9uQ29kZT9waG9uZT0iKyI4NTIiK3N0YXRlLnBob25lKQoKICAgICAgICBheGlvcy5wb3N0KCIvdG91cmlzdC9zZW5kU01TVmVyaWZpY2F0aW9uQ29kZT9waG9uZT0iICsgIjg1MiIgKyBzdGF0ZS5waG9uZSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICAgIF9Ub2FzdChyZXNwb25zZS5kYXRhLm1zZyk7CiAgICAgICAgfSk7CiAgICAgICAgdmFyIGRjID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInZlcmlmeUJ0biIpOwogICAgICAgIHZhciBjb3VudCA9IDYwOwoKICAgICAgICBpZiAoYXZhaWxhYmxlKSB7CiAgICAgICAgICBkYy5jbGFzc0xpc3QuYWRkKCJkaXNhYmxlIik7CiAgICAgICAgICBhdmFpbGFibGUgPSBmYWxzZTsKICAgICAgICAgIGRjLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgIHZhciB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY291bnQgLT0gMTsKICAgICAgICAgICAgZGMuaW5uZXJUZXh0ID0gIueZvOmAgempl+itieeivCgiICsgY291bnQgKyAiKSI7CgogICAgICAgICAgICBpZiAoY291bnQgPD0gMCkgewogICAgICAgICAgICAgIGRjLmNsYXNzTGlzdC5yZW1vdmUoImRpc2FibGUiKTsKICAgICAgICAgICAgICBkYy5pbm5lclRleHQgPSAi55m86YCB6amX6K2J56K8IjsKICAgICAgICAgICAgICBhdmFpbGFibGUgPSB0cnVlOwogICAgICAgICAgICAgIGRjLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIDEwMDApOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICB2YXIgb25TdWJtaXQgPSBmdW5jdGlvbiBvblN1Ym1pdCh2YWx1ZXMpIHsKICAgICAgaWYgKHN0YXRlLmRiQ29uZmlyZW1lZFB3ZCAhPSBzdGF0ZS5uZXdQYXNzd29yZCkgewogICAgICAgIF9Ub2FzdCgi5YWp5qyh5a+G56K85LiN55u45ZCMIik7CiAgICAgIH0KCiAgICAgIGNvbnNvbGUubG9nKCdzdWJtaXQnLCB2YWx1ZXMpOwogICAgICB2YXIgZGF0YSA9IHsKICAgICAgICBwaG9uZTogJzg1MicgKyBzdGF0ZS5waG9uZSwKICAgICAgICBuZXdQYXNzd29yZDogbWQ1KHN0YXRlLm5ld1Bhc3N3b3JkKSwKICAgICAgICBjb2RlOiBzdGF0ZS5jb2RlCiAgICAgIH07CiAgICAgIHZhciBoZWFkZXJzID0gewogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCIKICAgICAgfTsgLy8gYXhpb3MucG9zdCgiaHR0cDovLzEyMS4xOTkuNTQuNDM6ODg4OC90b3VyaXN0L2NoYW5nZVBhc3N3b3JkIiwgZGF0YSwge2hlYWRlcnN9KQoKICAgICAgYXhpb3MucG9zdCgiL3RvdXJpc3QvY2hhbmdlUGFzc3dvcmQiLCBkYXRhLCB7CiAgICAgICAgaGVhZGVyczogaGVhZGVycwogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZWdpc3Rlcl9yZXNwb25zZSkgewogICAgICAgIGNvbnNvbGUubG9nKHJlZ2lzdGVyX3Jlc3BvbnNlKTsKCiAgICAgICAgaWYgKHJlZ2lzdGVyX3Jlc3BvbnNlLmRhdGEuY29kZSA9PSAyMDApIHsKICAgICAgICAgIF9Ub2FzdCgiU3VjY2VzcyIpOwoKICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gIi4vb3JkZXIiOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfVG9hc3QocmVnaXN0ZXJfcmVzcG9uc2UuZGF0YS5tc2cpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigiVGhlcmUgd2FzIGFuIGVycm9yISIsIGVycm9yLm1lc3NhZ2UpOwogICAgICB9KTsKICAgIH07CgogICAgcmV0dXJuIHsKICAgICAgc3RhdGU6IHN0YXRlLAogICAgICBvblN1Ym1pdDogb25TdWJtaXQsCiAgICAgIHNlbmRTTVM6IHNlbmRTTVMKICAgIH07CiAgfQp9Ow=="},{"version":3,"sources":["C:\\Users\\Ares\\Desktop\\washing-master\\src\\components\\ForgetPwd.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"forgetPwd\">\r\n    <div class=\"pwd-form\">\r\n      <van-form @submit=\"onSubmit\">\r\n        <van-field\r\n            v-model=\"state.phone\"\r\n            type=\"tel\"\r\n            required\r\n            name=\"phone\"\r\n            label=\"手機號碼\"\r\n            placeholder=\"手機號碼\"\r\n            :rules=\"[{ required: true, message: '請輸入您的手機號碼' }]\"\r\n        />\r\n        <van-field\r\n            v-model=\"state.newPassword\"\r\n            type=\"password\"\r\n            required\r\n            name=\"newPassword\"\r\n            label=\"密碼\"\r\n            placeholder=\"密碼\"\r\n            :rules=\"[{ required: true, message: '請輸入您的密碼' }]\"\r\n        />\r\n        <van-field\r\n            v-model=\"state.dbConfiremedPwd\"\r\n            type=\"password\"\r\n            required\r\n            name=\"dbConfiremedPwd\"\r\n            label=\"密碼\"\r\n            placeholder=\"請再次輸入您的密碼\"\r\n            :rules=\"[{ required: true, message: '請再次輸入您的密碼' }]\"\r\n        />\r\n        <van-field\r\n            center\r\n            clearable\r\n            label=\"短信驗證碼\"\r\n            placeholder=\"請輸入您的短信驗證碼\"\r\n            required\r\n            v-model=\"state.code\"\r\n            :rules=\"[{ required: true, message: '請輸入您的短信驗證碼' }]\"\r\n        >\r\n          <template #button>\r\n            <van-button  @click=\"sendSMS\" size=\"small\" type=\"primary\" id=\"verifyBtn\">發送驗證碼</van-button>\r\n          </template>\r\n        </van-field>\r\n        <div class=\"button_center\" style=\"margin: 16px;\">\r\n            <van-button class=\"submit\" round block type=\"primary\" native-type=\"submit\">\r\n                提交\r\n            </van-button>\r\n        </div>\r\n      </van-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport VueCookies from 'vue-cookies'\r\nimport { reactive } from 'vue';\r\nimport axios from \"axios\";\r\nimport {Toast} from \"vant\";\r\nimport md5 from 'js-md5';\r\nexport default {\r\n  name:'PwdForm',\r\n  beforeMount() {\r\n    if(VueCookies.get(\"LoginStatus\")==1){\r\n      window.location.href=\"./order\";\r\n    }\r\n  },\r\n  setup() {\r\n    const state = reactive({\r\n      phone: '',\r\n      newPassword: '',\r\n      dbConfiremedPwd:'',\r\n      code:'',\r\n    });\r\n    var available=true;\r\n    const sendSMS = () => {\r\n      if(state.phone==\"\"){\r\n        Toast(\"請輸入你的聯絡電話\");\r\n      }else{\r\n        console.log(state.phone);\r\n        // axios.post(\"http://121.199.54.43:8888/tourist/sendSMSVerificationCode?phone=\"+\"852\"+state.phone)\r\n        axios.post(\"/tourist/sendSMSVerificationCode?phone=\"+\"852\"+state.phone)\r\n        .then(function(response){\r\n          // console.log(response);\r\n          Toast(response.data.msg);\r\n        });\r\n        let dc=document.getElementById(\"verifyBtn\");\r\n        let count=60;\r\n        if(available){\r\n          dc.classList.add(\"disable\");\r\n          available=false;\r\n          dc.disabled=true;\r\n          var timer=setInterval(function(){\r\n            count-=1;\r\n            dc.innerText=\"發送驗證碼(\"+count+\")\";\r\n            if(count<=0){\r\n              dc.classList.remove(\"disable\");\r\n              dc.innerText=\"發送驗證碼\";\r\n              available=true;\r\n              dc.disabled=false;\r\n              clearInterval(timer);\r\n            }\r\n          },1000);\r\n        }\r\n      }\r\n    };\r\n    const onSubmit = (values) => {\r\n        if(state.dbConfiremedPwd!=state.newPassword){\r\n          Toast(\"兩次密碼不相同\");\r\n        }\r\n      console.log('submit', values);\r\n      const data = {\r\n        phone: '852'+state.phone,\r\n        newPassword: md5(state.newPassword),\r\n        code:state.code,\r\n      }\r\n      const headers = {\r\n        \"Content-Type\" : \"application/json; charset=utf-8\",\r\n      }\r\n      // axios.post(\"http://121.199.54.43:8888/tourist/changePassword\", data, {headers})\r\n      axios.post(\"/tourist/changePassword\", data, {headers})\r\n        .then(function(register_response){\r\n          console.log(register_response);\r\n          if(register_response.data.code==200){\r\n            Toast(\"Success\");\r\n            window.location.href=\"./order\";\r\n          }else{\r\n            Toast(register_response.data.msg);\r\n          }\r\n        })\r\n        .catch(error => {\r\n          console.error(\"There was an error!\", error.message);\r\n        });\r\n    };\r\n    return {\r\n      state,\r\n      onSubmit,\r\n      sendSMS\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\nh3 {\r\n  margin: 40px 0 0;\r\n}\r\n.submit{\r\n  /*margin-left: 27px;*/\r\n  width:100%;\r\n}\r\nul {\r\n  list-style-type: none;\r\n  padding: 0;\r\n}\r\nli {\r\n  display: inline-block;\r\n  margin: 0 10px;\r\n}\r\na {\r\n  color: blue;\r\n}\r\n\r\n#verifyBtn.disable{\r\n  pointer-events: none;\r\n  background: grey;\r\n  border: 1px grey solid;\r\n}\r\n</style>\r\n"],"sourceRoot":""}]}